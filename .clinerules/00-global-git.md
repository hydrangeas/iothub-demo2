# タスク開始準備

`git status` で現在の git のコンテキストを確認します。
現在のブランチでの作業内容と、指示された内容に関連性が低い場合、別のタスクとして開始するよう提案してください。
無視するように言われた場合は、そのまま続行します。

## ブランチの新規作成と移動

タスクを開始する際は、リモートリポジトリが存在するか確認します。
確認は `git remote -v` を使用します。
既に `git` コマンドが存在することが判明している場合はスキップしてください。

リモートリポジトリがGitHubであった場合 `gh` コマンドが存在することを確認してください。
確認には `gh version` を使用してください。
既に `gh` コマンドが存在することが判明している場合はスキップしてください。

次に、タスクがIssueに登録されているか確認します。
タスクリストを確認するには `gh issue list` を使用します。
タスクの詳細を確認するには `gh issue view ##` を使用します。`##` はIssue番号です。

もしIssueに登録されている場合、ブランチ名は `feature/issue-##-description` としてください。
`##`はIssue番号、`description`はIssueの要約を英語で端的にまとめたものです。
`bug`ラベルが付与されている場合は `bug/issue-##-description` としてください。

タスクを開始する前に、ブランチを新規作成し、移動します。
新規作成と移動には `git checkout -b branch-name` としてください。
`branch-name`は上で決められたものです。
なお `feature/issue-##` または `bug/issue-##` までが同一のブランチが存在する場合、新しくブランチを作成することは禁じます。
その際は `git checkout branch-name` での移動のみとしてください。

## コミット

指示されたタスクの完了後 `git commit -m "comment"` を使用してコミットします。
`comment` は、タスクの要約を日本語で端的にまとめたコメントです。
タスク完了後は、必ずコミットしてください。

## プッシュ

リモートリポジトリが存在する場合 `git push REMOTE-NAME BRANCH-NAME` を使用してプッシュします。
コミット完了後、リモートリポジトリが存在する場合は、必ずプッシュしてください。
リモートリポジトリが存在しない場合は、このコマンドは実行しないでください。

## プルリクエスト

リモートリポジトリがGitHubである場合、プルリクエストを作成します。
コマンドは `gh pr create --title subject --body description --base main` です。
`subject` には `sub (issue #XX)` の形式とし `sub` にはタスクの要約を日本語で記載し `XX` にはIssue番号を記載してください。
`description` には作業内容を詳細に記載します。
`main` は、そのリポジトリのメインブランチを記載します。場合によって、main、master、defaultなどから判断してください。
なお、リモートリポジトリが存在しない場合は、このコマンドは実行しないでください。

## プルリクエストの指摘確認、修正

リモートリポジトリがGitHubである場合、プルリクエストに付されたコメントの確認は、下記を実行します。

```powershell
gh api -H "Accept: application/vnd.github+json" -H "X-GitHub-Api-Version: 2022-11-28" /repos/OWNER/REPO/pulls/PULL_NUMBER/comments
```

`OWNER` はリポジトリのユーザー名 `REPO` は当該ディレクトリのリポジトリ名 `PULL_NUMBER` はPR番号を使用してください。
コメントを確認し、必要があれば修正してください。
修正の必要がない場合は、PRに理由を書き込んでください。
修正を実施した場合は、上記に従って、コミット、プッシュを実施してください。

## プルリクエストのマージ

プルリクエストがマージされた場合、下記の処理を実施してください。
マージされたプルリクエストを特定してください。
すぐに判断できない場合、ユーザーに確認してください。

1. 不要ファイルの削除
   作業に使用した一時ファイルは削除してください。
2. メインブランチへの移動
   コマンドは `git checkout main` です。`main` は場合によって、master、defaultなどから判断してください。
3. ローカルブランチの削除
   作業に使用したブランチを削除してください。
4. リモートブランチの削除
   リモートブランチはマージ作業者が削除している場合もあります。
