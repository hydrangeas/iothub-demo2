# MachineLog.Monitor

MachineLog.Monitorは、ASP.NET 8.0とBlazor WebAssemblyを使用したWebアプリケーションで、産業機器のログデータを閲覧・分析するためのインターフェースを提供します。Azure IoT HubとUploadModuleLogsによってBlobストレージに保存されたデータにアクセスします。

## アプリケーション構成

- Blazorアーキテクチャ：Blazor WebAssembly（クライアントサイドレンダリング）
- UIフレームワーク：MudBlazor（マテリアルデザイン準拠）
- バックエンドAPI：ASP.NET Core Web API（RESTful設計）
- 認証：Microsoft Entra ID（旧Azure AD）

## ログ閲覧機能

- 機器IDによるフィルタリング（複数選択可能）
- 日時範囲による絞り込み（カスタム範囲指定可能）
- Severity（重要度）によるフィルタリング
- 全文検索（Message内のキーワード検索）
- ページネーション（デフォルト100件/ページ、最大1000件/ページ）
- エクスポート機能（CSV, JSON形式）

## ダッシュボード機能

- リアルタイムログ表示（WebSocketによる自動更新）
- 機器ステータス概要（稼働中、警告、エラー状態の機器数）
- 時系列グラフ（Severity別ログ数の推移）
- ヒートマップ（時間帯別のログ発生頻度）
- トップエラー分析（最も頻繁に発生するエラーの集計）

## レポート機能

- カスタムレポート作成（日次、週次、月次）
- レポートテンプレート（事前定義された分析レイアウト）
- スケジュール設定（定期的なレポート生成と配信）
- エクスポート形式（PDF, Excel）
- レポート共有機能（メール送信、リンク共有）

## アラート機能

- アラートルール設定（条件、しきい値の定義）
- 通知方法（メール、SMS、Webhook）
- アラート履歴の管理
- エスカレーションポリシーの設定

## パフォーマンス最適化

- コンポーネントの効率的な再レンダリング（ShouldRenderの最適化）
- 仮想化スクロール（Virtualizeコンポーネント）
- 遅延ロード（Lazy Loading）によるコード分割
- WebAssemblyのAOT（Ahead-of-Time）コンパイル
- HTTP/2プロトコルの活用
- ブラウザキャッシュ戦略（Cache-Control, ETag）
- 画像最適化（WebP形式、遅延ロード）
- ミニファイとバンドル（CSS, JavaScript）
- CDN活用による静的アセット配信

## 状態管理

- Fluxアーキテクチャ（Reduxパターン）
- 状態コンテナ（CascadingParameter, StateContainer）
- ブラウザストレージ活用（localStorage, sessionStorage）
- サーバーとの状態同期メカニズム

## API設計

- RESTful APIプリンシプルに準拠
- OpenAPI（Swagger）によるAPI文書化
- HTTPステータスコードの適切な使用
- バージョニング（URLパス、ヘッダー）
- レート制限の実装
- HATEOAS（Hypermedia as the Engine of Application State）の採用

## UI/UXデザイン

- レスポンシブデザイン（モバイル、タブレット、デスクトップ対応）
- ダークモード/ライトモード切替
- カスタマイズ可能なテーマ
- 直感的なナビゲーション構造
- プログレッシブ・ディスクロージャー（段階的な情報開示）

## セキュリティ対策

- Microsoft Entra IDによる認証
- ロールベースのアクセス制御（RBAC）
- クロスサイトスクリプティング（XSS）対策
- クロスサイトリクエストフォージェリ（CSRF）対策
- コンテンツセキュリティポリシー（CSP）の実装
- セキュアなHTTPヘッダーの設定
- 入力検証とサニタイゼーション
- セキュリティ監査ログの記録

## パフォーマンスモニタリング

- クライアントサイドパフォーマンス計測
- サーバーサイドメトリクス収集
- エラー追跡と分析
- ユーザーエクスペリエンス指標（Core Web Vitals）の監視
- WebAssemblyメモリ使用量の最適化

## アクセシビリティ

- WAI-ARIA準拠（ロール、状態、プロパティの適切な使用）
- キーボードナビゲーション対応
- スクリーンリーダー互換性
- カラーコントラスト最適化（WCAG AAA基準）
- フォーカス管理の改善
- 代替テキストの提供
- アクセシビリティテストの自動化

## 多言語対応（i18n）

- リソースファイルベースの翻訳システム
- 10言語のサポート（日本語、英語、中国語、スペイン語など）
- 日時、数値、通貨のローカライズ
- 右から左へ（RTL）の言語サポート
- 言語自動検出と切り替え機能
- 翻訳管理ワークフロー

## SEO最適化

- SEOフレンドリーなURL構造
- メタタグの最適化（タイトル、説明）
- 構造化データ（JSON-LD）の実装
- サイトマップの自動生成
- パフォーマンス最適化（Core Web Vitals対応）

## URL設計

- RESTfulな階層構造
- 機器IDによるルーティング（/machines/{id}/logs）
- 日付範囲によるフィルタリング（クエリパラメータ）
- クリーンURL（人間可読性の高いパス）

## Azure統合

- IoT Hubとの直接連携
- 機器IDによるデータアクセス制限
- Azure Storage APIを使用したBlobデータ取得
- Azure Application Insightsによる監視
- Azure CDNによる静的コンテンツ配信
- Azure Functions連携（バックグラウンド処理）
- UploadModuleLogsによるデータアップロード
